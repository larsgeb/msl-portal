<!DOCTYPE html>
<html lang="en">

<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>MSL + M1: Seamless GPU acceleration</title>
  <meta name="description" content="">
  <meta name="author" content="Lars Gebraad, Andreas Fichtner">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href='//fonts.googleapis.com/css?family=Raleway:400,300,600' rel='stylesheet' type='text/css'>

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="css/custom.css">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <link rel="stylesheet" href="css/github-prettify-theme.css">
  <script src="js/site.js"></script>

</head>

<body class="code-snippets-visible">
  <div class="container">
    <section class="header">

      <div class="value-props row">
        <div class="three columns value-prop"></div>
        <div class="twelve columns value-prop">
          <div class="row">
            <div class="twelve columns">
              <h6>
                <b>Seamless GPU acceleration for C++ based physics using unified processing units:</b>
                </br>
                A case study for elastic wave propagation and PDE-constrained optimization
              </h6>
            </div>
            <div class="twelve columns">May 2022</div>
          </div>
          </br>
          <div class="row">
            <div class="six columns">Lars Gebraad</br>lars.gebraad@erdw.ethz.ch</div>
            <div class="six columns">Andreas Fichtner</div>
            <div class="twelve columns" style="margin-top: 20px;"><a href="https://cos.ethz.ch/">Seismology and Wave
                Physics</a></br>ETH Zürich
            </div>
          </div>
        </div>
        <div class="three columns value-prop"> </div>
      </div>

      <div class="value-props row">
        <div class="four columns value-prop">
          <a href="">ArXiv Preprint</a>
        </div>
        <div class="four columns value-prop">
          <a href="https://github.com/larsgeb/m1-gpu-cpp">Basic operations benchmarking</a>
        </div>
        <div class="four columns value-prop">
          <a href="https://github.com/larsgeb/psvWave/tree/gpu">Elastic wave propagation</a></br>
        </div>
      </div>

      <div class="value-props row">
        <div style="text-align:justify;" class="twelve columns value-prop">
          <p>
            This page serves as a directory for codes related to the above-mentioned
            manuscript. Please write us on GitHub or email us for any
            questions relating the manuscript or the codes.
          </p>
          <p>
            The M1 series of chips produced by Apple have proven a capable and power-efficient alternative to mainstream
            Intel and AMD x86 processors for everyday tasks. Additionally, the unified design integrating the central
            processing and graphics processing unit, have allowed these M1 chips to excel at many tasks with heavy
            graphical requirements without the need for a discrete graphical processing unit (GPU), and in some cases
            even outperforming discrete GPUs.
          </p>
          <p>
            In this work, we show how the M1 chips can be leveraged using the Metal Shading Language (MSL) to accelerate
            typical array operations in C++. More importantly, we show how the usage of MSL avoids the typical
            complexity of CUDA or OpenACC memory management, by allowing the central processing unit (CPU) and GPU to
            work in unified memory. We demonstrate how performant the M1 chips are on standard 1D and 2D array
            operations such as array addition, SAXPY and finite difference stencils, with respect to serial and OpenMP
            accelerated CPU code. The reduced complexity of implementing MSL also allows us to accelerate an existing
            elastic wave equation solver (originally based on OpenMP accelerated C++) using MSL, with minimal effort,
            while retaining all CPU and OpenMP functionality.
          </p>
          <p>
            The resulting performance gain of simulating the wave equation is near an order of magnitude for specific
            settings. This gain attained from using MSL is similar to other GPU-accelerated wave-propagation codes with
            respect to their CPU variants, but does not come at much increased programming complexity that prohibits the
            typical scientific programmer to leverage these accelerators. This result shows how unified processing units
            can be a valuable tool to seismologists and computational scientists in general, lowering the bar to writing
            performant codes that leverage modern GPUs.
          </p>
        </div>
      </div>


    </section>


    <div class="docs-section" id="intro">

      <div class="value-props row">
        <div class="three columns value-prop"></div>
        <div class="six columns value-prop">
          Copyright 2022, Lars Gebraad, Andreas Fichtner, Seismology and Wave Physics, ETH Zürich.
        </div>
        <div class="three columns value-prop"> </div>
      </div>
    </div>
</body>

</html>